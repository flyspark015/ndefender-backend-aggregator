# N-Defender GREEN SIGNAL Report

Generated: 2026-02-22T15:24:18Z
Hostname: ndefender-pi

## Summary (PASS/FAIL)
| Component | Status | Evidence |
| --- | --- | --- |
| Public REST | PASS | all endpoints 200 via curl + urllib |
| Public CORS | PASS | OPTIONS /status 200 with allow-* |
| Public WS | PASS | 3 msgs, envelope valid |
| Local REST | PASS | all endpoints 200 |
| Local WS | PASS | 3 msgs, envelope valid |
| Command Write Path | FAIL | no command endpoints (see Command section) |
| RemoteID Engine | DEGRADED | tshark errors in journal, state=DEGRADED |
| RF Scan | PASS | scan_active true, timestamps advance |
| ESP32 Link | PASS | status CONNECTED |
| GPS | PASS | mode=3 with lat/lon |

## Public REST Evidence (curl)
``
GET /health   -> 200 {"status":"ok","timestamp_ms":1771773836334}

GET /status   -> 200 {"audio":{"muted":false,"volume_percent":100},"contacts":[{"id":"rf:5828000000","last_seen_ts":1771773837580,"type":"UNKNOWN_RF","unknown_rf":{"bandwidth_class":"narrow","center_hz":5828000000,"family
GET /contacts -> 200 {"contacts":[{"id":"rf:5836000000","last_seen_ts":1771773838636,"type":"UNKNOWN_RF","unknown_rf":{"bandwidth_class":"narrow","center_hz":5836000000,"family_hint":"unknown","peak_db":79.54641621316478,
GET /system   -> 200 {"cpu_temp_c":59.5,"cpu_usage_percent":65.03192932068558,"disk_total_gb":117,"disk_used_gb":69,"load_15m":6.63427734375,"load_1m":7.28125,"load_5m":6.9951171875,"ram_total_mb":16215,"ram_used_mb":7859
GET /power    -> 200 {"current_a":null,"input_power_w":null,"input_vbus_v":null,"pack_voltage_v":null,"per_cell_v":null,"soc_percent":null,"state":null,"status":"degraded","time_to_empty_s":null,"time_to_full_s":null}

GET /rf       -> 200 {"last_event":{"id":"rf:5828000000","last_seen_ts":1771773840315,"type":"UNKNOWN_RF","unknown_rf":{"bandwidth_class":"narrow","center_hz":5828000000,"family_hint":"unknown","peak_db":78.37622866323818
GET /video    -> 200 {"selected":1,"status":"ok"}

GET /services -> 200 [{"active_state":"active","name":"ndefender-backend","restart_count":0,"sub_state":"running"},{"active_state":"active","name":"ndefender-kiosk","restart_count":0,"sub_state":"running"},{"active_state"
GET /network  -> 200 {"connected":true,"ip_v4":"192.168.1.35","ip_v6":"2401:4900:8fef:a440:ae02:e0f1:7805:a92e","ssid":"Airtel_Toybook","status":"ok"}

GET /audio    -> 200 {"muted":false,"status":"ok","volume_percent":100}

```

## Public REST Evidence (Python urllib)
``
health 200 {"status":"ok","timestamp_ms":1771773844293}

status 200 {"audio":{"muted":false,"volume_percent":100},"contacts":[{"id":"rf:5884000000",
contacts 200 {"contacts":[{"id":"rf:5896000000","last_seen_ts":1771773846523,"type":"UNKNOWN_
system 200 {"cpu_temp_c":59.5,"cpu_usage_percent":65.03257862228762,"disk_total_gb":117,"di
power 200 {"current_a":null,"input_power_w":null,"input_vbus_v":null,"pack_voltage_v":null
rf 200 {"last_event":{"id":"rf:5890000000","last_seen_ts":1771773848286,"type":"UNKNOWN
video 200 {"selected":1,"status":"ok"}

services 200 [{"active_state":"active","name":"ndefender-backend","restart_count":0,"sub_stat
network 200 {"connected":true,"ip_v4":"192.168.1.35","ip_v6":"2401:4900:8fef:a440:ae02:e0f1:
audio 200 {"muted":false,"status":"ok","volume_percent":100}

```

## Public CORS Preflight
``
HTTP/2 200 
date: Sun, 22 Feb 2026 15:24:13 GMT
content-type: text/html; charset=utf-8
access-control-allow-headers: Content-Type,X-API-Key,X-Role
access-control-allow-methods: GET,POST,OPTIONS
access-control-allow-origin: *
access-control-max-age: 86400
allow: HEAD, GET, OPTIONS
server: cloudflare
cf-cache-status: DYNAMIC
nel: {"report_to":"cf-nel","success_fraction":0.0,"max_age":604800}
report-to: {"group":"cf-nel","max_age":604800,"endpoints":[{"url":"https://a.nel.cloudflare.com/report/v4?s=gW1PBngsf5vKrPOEs%2FYvCzyMIEe0YJkeI3mydw11bSNPrz5LysZznKV5LK1yHeXrVHT2S%2FZWV%2ByjJM3BhMNW07NbOHY%2Bk6MVey4f1FSyhFFxCYTHMT9qKG4%3D"}]}
```

## WebSocket Verification
Public wss://n.flyspark.in/api/v1/ws
``
msgs_received=3
envelope_valid=True
first_200={"type":"CONTACT_NEW","timestamp":1771773855080,"source":"rf_sensor","data":{"id":"rf:2404000000","type":"UNKNOWN_RF","last_seen_ts":1771773854852,"unknown_rf":{"center_hz":2404000000,"snr_db":12.1627
```
Local ws://127.0.0.1:8000/api/v1/ws
``
msgs_received=3
envelope_valid=True
first_200={"type":"CONTACT_NEW","timestamp":1771773855687,"source":"remote_id","data":{"contact":{"id":"rid:opid:GBR-OP-123ABCD","type":"REMOTE_ID","last_ts":1620849813192,"last_seen_ts":1620849813192,"source":
```

## Local REST Evidence (curl)
``
GET /health -> 200 {"status":"ok","timestamp_ms":1771773858314}

GET /status -> 200 {"audio":{"muted":false,"volume_percent":100},"contacts":[{"id":"rf:2428000000","last_seen_ts":1771773858107,"type":"UNKNOWN_RF","unknown_rf":{"bandwidth_class":"narrow","center_hz":2428000000,"family
```

## Command Tests (Write Path)
Generic endpoint probe (POST): /command=405, /cmd=405, /control=405
Result: FAIL (no write endpoints exposed).

## Service Health (systemctl)
``
active
active
active
active
active
```

## Subsystem Checks
``
rf_sensor.scan_active=True
rf_sensor.state=ok
rf.last_timestamp_ms=1771773857606
rf.last_timestamp_ms_delta=1962
remote.health.capture_active=True
remote.health.state=DEGRADED
remote.health.last_error=None
esp32.status=CONNECTED
esp32.last_ts=1771773858203
gps.mode=3
gps.lat=23.1752215 gps.lon=72.6298401
```

## Verdict
GREEN SIGNAL (API + WS + CORS are fully PASS).
Note: Write command endpoints are not implemented; RemoteID engine is DEGRADED due to tshark/mon0 errors.

## Next Actions (if desired)
1) Expose command endpoints for write tests (e.g., /command or /vrx/tune).
2) Fix RemoteID capture device (mon0/tshark) to clear DEGRADED state.
